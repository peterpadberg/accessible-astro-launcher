---
/**
 * LauncherLink Component
 *
 * @description A semantic anchor element for navigation within the launcher.
 * Supports custom icons and search keywords.
 */

interface Props {
  /**
   * Display label for the link
   */
  label: string
  /**
   * URL to navigate to
   */
  href: string
  /**
   * Additional search keywords for filtering
   */
  keywords?: string[]
  /**
   * Label for the type indicator (i18n support)
   * @default "Go to"
   */
  typeLabel?: string
  /**
   * Additional classes to apply
   */
  class?: string
  /**
   * HTML attributes to spread on the anchor (e.g., target, rel)
   */
  [key: string]: string | string[] | undefined
}

const {
  label,
  href,
  keywords = [],
  typeLabel = 'Go to',
  class: className,
  ...rest
} = Astro.props

// Generate unique ID for the link
const linkId = `launcher-link-${Math.random().toString(36).substring(2, 9)}`

// Data attributes for search/filtering
const dataAttrs = {
  'data-label': label,
  'data-keywords': keywords.join(','),
  'data-href': href,
}
---

<li class:list={['launcher-link-wrapper', className]}>
  <a id={linkId} href={href} class="launcher-link" tabindex="-1" {...dataAttrs} {...rest}>
    <span class="icon">
      <slot name="icon">
        <svg
          xmlns="http://www.w3.org/2000/svg"
          width="16"
          height="16"
          viewBox="0 0 24 24"
          fill="none"
          stroke="currentColor"
          stroke-width="2"
          stroke-linecap="round"
          stroke-linejoin="round"
          aria-hidden="true"
        >
          <path
            d="M6 22a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h8a2.4 2.4 0 0 1 1.704.706l3.588 3.588A2.4 2.4 0 0 1 20 8v12a2 2 0 0 1-2 2z"
          ></path>
          <path d="M14 2v5a1 1 0 0 0 1 1h5"></path>
          <path d="M10 9H8"></path>
          <path d="M16 13H8"></path>
          <path d="M16 17H8"></path>
        </svg>
      </slot>
    </span>
    <span class="text">
      <span class="label">{label}</span>
    </span>
    <span class="type" aria-hidden="true">
      {typeLabel}
    </span>
  </a>
</li>

<style>
  :where(.launcher-link-wrapper) {
    list-style: none;
  }

  :where(.launcher-link) {
    display: flex;
    justify-content: space-between;
    align-items: center;
    gap: var(--launcher-space-sm);
    transition:
      background-color var(--launcher-animation-duration) var(--launcher-animation-timing),
      translate var(--launcher-animation-duration) var(--launcher-animation-timing);
    cursor: pointer;
    border-radius: var(--launcher-radius-md);
    background-color: transparent;
    padding: var(--launcher-space-xs) var(--launcher-space-sm);
    inline-size: 100%;
    scroll-margin-block-start: calc(var(--launcher-space-xl) + var(--launcher-space-sm));
    color: var(--launcher-text-color);
    text-decoration: none;
  }

  :where(.launcher-link[data-active]),
  :where(.launcher-link:hover),
  :where(.launcher-link:focus-visible) {
    translate: 0 -2px;
    background-color: var(--launcher-interaction-color);
  }

  :where(.launcher-link:focus-visible) {
    outline: 2px solid var(--launcher-text-color);
    outline-offset: 2px;
  }

  :where(.launcher-link[data-active]) .type {
    opacity: 1;
  }

  :where(.icon) {
    display: flex;
    flex-shrink: 0;
    align-items: center;
    margin-block-start: -1px;
  }

  :where(.text) {
    display: flex;
    flex: 1;
    min-inline-size: 0;
  }

  :where(.label) {
    overflow: hidden;
    font-size: var(--launcher-font-size-lg);
    line-height: var(--launcher-line-height);
    text-overflow: ellipsis;
    white-space: nowrap;
  }

  :where(.type) {
    flex-shrink: 0;
    opacity: 0;
    transition: opacity var(--launcher-animation-duration) var(--launcher-animation-timing);
    font-size: var(--launcher-font-size-sm);
    text-transform: uppercase;
  }

  :where(.launcher-link:hover) .type,
  :where(.launcher-link:focus-visible) .type {
    opacity: 1;
  }

  /* Respect reduced motion preferences */
  @media (prefers-reduced-motion: reduce) {
    :where(.launcher-link),
    :where(.type) {
      transition: none;
    }

    :where(.launcher-link[data-active]),
    :where(.launcher-link:hover),
    :where(.launcher-link:focus-visible) {
      translate: 0 0;
    }
  }
</style>
